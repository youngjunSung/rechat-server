{"version":3,"file":"829.js","mappings":"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","sources":["webpack://sleact-ts-front/./src/components/Button.tsx","webpack://sleact-ts-front/./src/components/TextField.tsx","webpack://sleact-ts-front/./src/components/ChatBox.tsx","webpack://sleact-ts-front/./src/components/ChatList.tsx","webpack://sleact-ts-front/./src/components/Chat.tsx","webpack://sleact-ts-front/./src/hooks/useInput.ts","webpack://sleact-ts-front/./src/hooks/useSocket.ts","webpack://sleact-ts-front/./node_modules/@mui/icons-material/esm/PersonAdd.js","webpack://sleact-ts-front/./src/pages/Channel.tsx","webpack://sleact-ts-front/./src/utils/fetcher.ts","webpack://sleact-ts-front/./src/utils/makeSection.ts"],"sourcesContent":["import React from 'react';\r\n\r\ninterface ButtonProps {\r\n  className?: string;\r\n  text: string;\r\n  onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void;\r\n}\r\n\r\nexport const Button: React.FC<ButtonProps> = ({ className, text, onClick }) => {\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      onClick={onClick}\r\n      className={`flex items-center justify-center min-h-[54px] px-[10px] w-full bg-primary text-white rounded-[8px] text-[16px] font-bold ${className}`}\r\n    >\r\n      {text}\r\n    </button>\r\n  );\r\n};\r\n","import React, { memo } from 'react';\r\n\r\ninterface TextFieldProps {\r\n  id?: string;\r\n  label?: string;\r\n  type?: React.HTMLInputTypeAttribute;\r\n  className?: string;\r\n  onChange?: (event: React.ChangeEvent<HTMLInputElement>) => void;\r\n  value?: string | number | readonly string[] | undefined;\r\n}\r\n\r\nexport const TextField: React.FC<TextFieldProps> = memo(({ id, label, type = 'text', className, onChange, value }) => {\r\n  // console.log(`${label} 렌더링!`);\r\n  return (\r\n    <div className={`flex flex-col [&:not(&:last-child)]:mb-[20px] ${className}`}>\r\n      <label htmlFor={id} className=\"mb-[4px] text-primary text-[14px] font-[500]\">\r\n        {label}\r\n      </label>\r\n      <input\r\n        type={type}\r\n        id={id}\r\n        className=\"py-[10px] border-b-[2px] border-primary border-solid rounded-none focus:outline-none\"\r\n        onChange={onChange}\r\n        value={value}\r\n      />\r\n    </div>\r\n  );\r\n});\r\n","import React, { useRef, useEffect, useCallback } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport autosize from 'autosize';\r\nimport gravatar from 'gravatar';\r\nimport { Mention, MentionsInput, MentionsInputClass, SuggestionDataItem } from 'react-mentions';\r\nimport fetcher from '@utils/fetcher';\r\nimport useSWR from 'swr';\r\nimport { IUser, IDM } from '@typings/db';\r\n\r\ninterface ChatBoxProps {\r\n  chat: string;\r\n  onSubmit: (e: any) => void;\r\n  onChangeChat: (e: any) => void;\r\n  placeholder?: string;\r\n}\r\n\r\nexport const ChatBox = ({ chat, onSubmit, onChangeChat, placeholder }: ChatBoxProps) => {\r\n  const params = useParams();\r\n  const refTextarea = useRef<HTMLTextAreaElement>(null);\r\n  const {\r\n    data: workspaceMembers,\r\n    error: error4,\r\n    mutate: mutate4,\r\n  } = useSWR<IUser[] | undefined>(`/api/workspaces/${params.workspace}/members`, fetcher);\r\n  const onKeyDownChat = (e: React.KeyboardEvent) => {\r\n    // console.log(e);\r\n    if (e.key === 'Enter' && e.shiftKey === false && chat.trim()) {\r\n      // console.log(e);\r\n      onSubmit(e);\r\n    }\r\n  };\r\n  const renderSuggestion = useCallback(\r\n    (\r\n      suggestion: SuggestionDataItem,\r\n      search: string,\r\n      highlightedDisplay: React.ReactNode,\r\n      index: number,\r\n      focused: boolean,\r\n    ): React.ReactNode => {\r\n      if (!workspaceMembers) return;\r\n      return (\r\n        <button type=\"button\" className={`w-full flex ${focused ? `bg-gray-400` : `white`}`}>\r\n          <img src={gravatar.url(workspaceMembers[index].email, { s: '24px', d: 'retro' })} alt=\"\" />\r\n          <span>{highlightedDisplay}</span>\r\n        </button>\r\n      );\r\n    },\r\n    [],\r\n  );\r\n  useEffect(() => {\r\n    if (refTextarea.current) {\r\n      autosize(refTextarea.current);\r\n    }\r\n  }, []);\r\n  return (\r\n    <div className=\"px-[20px] pb-[20px]\">\r\n      <MentionsInput\r\n        rows={1} // autosize 플러그인 사용 시 기본 높이 제어 속성\r\n        inputRef={refTextarea}\r\n        value={chat}\r\n        onChange={onChangeChat}\r\n        onKeyDown={onKeyDownChat}\r\n        placeholder={placeholder}\r\n        allowSuggestionsAboveCursor\r\n        className=\"resize-none [&_textarea]:!p-[10px] p-[10px] border-[1px] border-gray-300 border-solid w-full rounded-[8px]\"\r\n      >\r\n        <Mention\r\n          appendSpaceOnAdd\r\n          trigger=\"@\"\r\n          data={workspaceMembers?.map((v) => ({ id: v.id, display: v.nickname })) || []}\r\n          renderSuggestion={renderSuggestion}\r\n        />\r\n      </MentionsInput>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useRef, useCallback, useMemo, forwardRef } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { IUser, IChat, IDM } from '@typings/db';\r\nimport gravatar from 'gravatar';\r\nimport dayjs from 'dayjs';\r\nimport { Scrollbars, positionValues } from 'react-custom-scrollbars';\r\nimport regexifyString from 'regexify-string';\r\nimport { Chat } from '@components';\r\n\r\ninterface ChatListProps {\r\n  chatData: { [key: string]: (IDM | IChat)[] };\r\n  setScrollValues: React.Dispatch<React.SetStateAction<positionValues | undefined>>;\r\n  setSize: (size: number | ((_size: number) => number)) => Promise<(IDM[] | IChat[])[] | undefined>;\r\n  isEmpty: boolean;\r\n  isReachingEnd: boolean;\r\n}\r\n\r\nexport const ChatList = forwardRef(\r\n  ({ chatData, setScrollValues, setSize, isEmpty, isReachingEnd }: ChatListProps, ref: React.LegacyRef<Scrollbars>) => {\r\n    const refScrollbars = useRef<Scrollbars>(null);\r\n    // const result = regexifyString({\r\n    //   input: chatData?.content,\r\n    //   pattern: /@\\[(.+?)]\\((\\d+?)\\)|\\n/g,\r\n    //   decorator(match, index) {\r\n    //     const arr: string[] | null = match.match(/@\\[(.+?)]\\((\\d+?)\\)/)!;\r\n    //     if (arr) {\r\n    //       return (\r\n    //         <Link key={match + index} to={`/workspace/${workspace}/dm/${arr[2]}`}>\r\n    //           @{arr[1]}\r\n    //         </Link>\r\n    //       );\r\n    //     }\r\n    //     return <br key={index} />;\r\n    //   },\r\n    // });\r\n    const handleScroll = useCallback(\r\n      (values: positionValues) => {\r\n        // setScrollValues(values);\r\n        if (values.scrollTop === 0 && !isReachingEnd) {\r\n          setSize((prevSize) => prevSize + 1).then(() => {\r\n            const current = (refScrollbars as React.MutableRefObject<Scrollbars>)?.current;\r\n            if (current) {\r\n              current.scrollTop(current.getScrollHeight() - values.scrollHeight);\r\n            }\r\n          });\r\n        }\r\n        console.log(values);\r\n      },\r\n      [refScrollbars, isReachingEnd, setSize],\r\n    );\r\n    return (\r\n      <Scrollbars ref={ref} onScrollFrame={handleScroll} autoHide>\r\n        <div className=\"flex flex-col flex-1 py-[16px] px-[20px]\">\r\n          {Object.entries(chatData).map(([date, chats]) => {\r\n            return (\r\n              <div key={date}>\r\n                <div className=\"center sticky top-[6px]\">\r\n                  <p className=\"px-[10px] py-[4px] border-[#eee] border-[1px] rounded-full text-[#777] text-[12px]\">\r\n                    {date}\r\n                  </p>\r\n                </div>\r\n                {chats.map((chat: any, idx: number) => {\r\n                  return <Chat key={chat.id} chat={chat} />;\r\n                })}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </Scrollbars>\r\n    );\r\n  },\r\n);\r\n","import React, { useRef, useCallback, useMemo } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { IUser, IChat, IDM } from '@typings/db';\r\nimport gravatar from 'gravatar';\r\nimport dayjs from 'dayjs';\r\nimport Scrollbars from 'react-custom-scrollbars';\r\nimport regexifyString from 'regexify-string';\r\n\r\nexport const Chat = ({ chat }: { chat: IChat | IDM }) => {\r\n  const user = 'Sender' in chat ? chat.Sender : chat.User;\r\n  return (\r\n    <div className=\"flex items-start\">\r\n      <button type=\"button\" className=\"mt-[4px] flex items-center justify-center rounded-[4px] overflow-hidden\">\r\n        <img src={gravatar.url(user.email, { s: '24px', d: 'retro' })} alt=\"\" />\r\n      </button>\r\n      <div className=\"ml-[6px]\">\r\n        <div className=\"flex items-center mb-[4px]\">\r\n          <p className=\"text-[16px] text-black font-[600] mr-[4px]\">{user.nickname}</p>\r\n          <p className=\"text-[12px] text-gray-500 font-[400]\">{dayjs(chat.createdAt).format('h:mm A')}</p>\r\n        </div>\r\n        <p>{chat.content}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import { Dispatch, SetStateAction, useState, useCallback } from 'react';\r\n\r\ntype ReturnTypes<T> = [T, Dispatch<SetStateAction<T>>, (e: React.ChangeEvent<HTMLInputElement>) => void];\r\n\r\nexport const useInput = <T>(initialData: T): ReturnTypes<T> => {\r\n  const [state, setState] = useState(initialData);\r\n  const handler = useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      setState(e.target.value as unknown as T);\r\n    },\r\n    [state],\r\n  );\r\n  return [state, setState, handler];\r\n};\r\n","import io from 'socket.io-client';\r\nimport { useCallback } from 'react';\r\n\r\nconst backUrl = 'http://localhost:3095';\r\n\r\nconst sockets: { [key: string]: SocketIOClient.Socket } = {};\r\nconst useSocket = (workspace?: string): [SocketIOClient.Socket | undefined, () => void] => {\r\n  const disconnect = useCallback(() => {\r\n    if (workspace) {\r\n      sockets[workspace].disconnect();\r\n      delete sockets[workspace];\r\n    }\r\n  }, [workspace]);\r\n  if (!workspace) {\r\n    return [undefined, disconnect];\r\n  }\r\n  if (!sockets[workspace]) {\r\n    sockets[workspace] = io.connect(`${backUrl}/ws-${workspace}`, {\r\n      transports: ['websocket'],\r\n    });\r\n  }\r\n  return [sockets[workspace], disconnect];\r\n};\r\n\r\nexport default useSocket;\r\n","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4\"\n}), 'PersonAdd');","import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport WorkSpace from '../layouts/WorkSpace';\r\nimport { useParams } from 'react-router-dom';\r\nimport useSocket from '@hooks/useSocket';\r\nimport useSWR from 'swr';\r\nimport useSWRInfinite from 'swr/infinite';\r\nimport fetcher from '@utils/fetcher';\r\nimport { useInput } from '@hooks/useInput';\r\nimport { ChatBox, ChatList, TextField, Button } from '@components';\r\nimport { IUser, IDM, IChannel, IChat } from '@typings/db';\r\nimport axios from 'axios';\r\nimport gravatar from 'gravatar';\r\nimport dayjs from 'dayjs';\r\nimport { Scrollbars, positionValues } from 'react-custom-scrollbars';\r\nimport { PersonAdd } from '@mui/icons-material/';\r\nimport { Menu, MenuItem, Popover, Divider, Dialog, DialogActions, DialogContent, DialogTitle } from '@mui/material';\r\nimport makeSection from '@utils/makeSection';\r\n\r\nconst Channel = () => {\r\n  const { workspace, channel, id } = useParams();\r\n  const [socket] = useSocket(workspace);\r\n\r\n  const refScrollbars = useRef<Scrollbars>(null);\r\n  const [scrollValues, setScrollValues] = useState<positionValues>();\r\n  const [chat, setChat, onChangeChat] = useInput('');\r\n  const [newChannelMember, setNewChannelMember, onChangeNewChannelMember] = useInput('');\r\n  const [openDialogInviteChannel, setOpenDialogInviteChannel] = useState(false);\r\n  const handleDialogInviteChannelOpen = () => {\r\n    setOpenDialogInviteChannel(true);\r\n  };\r\n  const handleDialogInviteChannelClose = () => {\r\n    setOpenDialogInviteChannel(false);\r\n  };\r\n  const handleInviteChannel = () => {\r\n    axios\r\n      .post(\r\n        `/api/workspaces/${workspace}/channels/${channel}/members`,\r\n        { email: newChannelMember },\r\n        {\r\n          withCredentials: true,\r\n        },\r\n      )\r\n      .then(() => {\r\n        setNewChannelMember('');\r\n        handleDialogInviteChannelClose();\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n  const { data: myData } = useSWR<IUser>('/api/users', fetcher);\r\n  const { data: channelData } = useSWR<IChannel>(`/api/workspaces/${workspace}/channels/${channel}`, fetcher);\r\n  const { data: channelMembersData } = useSWR<IUser[]>(\r\n    myData ? `/api/workspaces/${workspace}/channels/${channel}/members` : null,\r\n    fetcher,\r\n  );\r\n  const {\r\n    data: chatData,\r\n    error: error2,\r\n    mutate: mutate2,\r\n    setSize,\r\n  } = useSWRInfinite<IChat[]>(\r\n    (index) => `/api/workspaces/${workspace}/channels/${channel}/chats?perPage=20&page=${index + 1}`,\r\n    fetcher,\r\n  );\r\n  const isEmpty = chatData?.[0]?.length === 0;\r\n  const isReachingEnd = isEmpty || (chatData && chatData[chatData.length - 1]?.length < 20) || false;\r\n  const onSubmit = useCallback(() => {\r\n    console.log('메세지 전송');\r\n    if (chat?.trim() && myData && chatData && channelData) {\r\n      const savedChat = chat;\r\n      mutate2((prevChatData) => {\r\n        prevChatData?.[0].unshift({\r\n          id: (chatData[0][0]?.id || 0) + 1,\r\n          content: savedChat,\r\n          UserId: myData.id,\r\n          User: myData,\r\n          ChannelId: channelData.id,\r\n          Channel: channelData,\r\n          createdAt: new Date(),\r\n        });\r\n        return prevChatData;\r\n      }, false).then(() => {\r\n        setChat('');\r\n        setTimeout(() => {\r\n          console.log('스크롤 이동2222');\r\n          refScrollbars.current?.scrollToBottom();\r\n        }, 100);\r\n      });\r\n      axios\r\n        .post(\r\n          `/api/workspaces/${workspace}/channels/${channel}/chats`,\r\n          { content: chat },\r\n          {\r\n            withCredentials: true,\r\n          },\r\n        )\r\n        .then(() => {\r\n          setChat('');\r\n          mutate2();\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n        });\r\n    }\r\n  }, [chat]);\r\n  useEffect(() => {\r\n    socket?.on('message', (data: number[]) => {\r\n      console.log('메세지 수신');\r\n      mutate2();\r\n    });\r\n    return () => {\r\n      socket?.off('message');\r\n    };\r\n  }, []);\r\n  useEffect(() => {\r\n    if (chatData?.length === 1) {\r\n      setTimeout(() => {\r\n        refScrollbars.current?.scrollToBottom();\r\n      }, 100);\r\n    }\r\n  }, [chatData]);\r\n  console.log(chatData);\r\n  const remakedChatData = makeSection(chatData ? [...chatData].flat().reverse() : []);\r\n  console.dir(remakedChatData);\r\n  console.log(scrollValues);\r\n  return (\r\n    <>\r\n      <div className=\"flex items-center py-[16px] px-[20px] border-b border-b-[#eee]\">\r\n        <h3 className=\"text-[18px] font-bold text-black\">{channel}</h3>\r\n        <button type=\"button\" onClick={handleDialogInviteChannelOpen} className=\"ml-auto center\">\r\n          <PersonAdd />\r\n        </button>\r\n        <Dialog\r\n          open={openDialogInviteChannel}\r\n          onClose={handleDialogInviteChannelClose}\r\n          aria-labelledby=\"alert-dialog-title\"\r\n          aria-describedby=\"alert-dialog-description\"\r\n        >\r\n          <DialogTitle id=\"alert-dialog-title\">\r\n            <span className=\"text-[18px] text-primary font-bold\">사용자 초대</span>\r\n          </DialogTitle>\r\n          <DialogContent>\r\n            <TextField label=\"이메일\" type=\"email\" value={newChannelMember} onChange={onChangeNewChannelMember} />\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button text=\"초대하기\" onClick={handleInviteChannel} />\r\n          </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n      <div className=\"flex flex-col-reverse flex-1\">\r\n        <ChatList\r\n          chatData={remakedChatData}\r\n          ref={refScrollbars}\r\n          setScrollValues={setScrollValues}\r\n          setSize={setSize}\r\n          isEmpty={isEmpty}\r\n          isReachingEnd={isReachingEnd}\r\n        />\r\n      </div>\r\n      <ChatBox chat={chat} onChangeChat={onChangeChat} onSubmit={onSubmit} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Channel;\r\n","import axios from 'axios';\r\n\r\nconst fetcher = (url: string) =>\r\n  axios\r\n    .get(url, {\r\n      // 프론트 서버와 백엔드 서버의 도메인이 다를 경우에도 백엔드에서 생성한 쿠키를 프론트로 주고 받게 할 수 있는 옵션\r\n      withCredentials: true,\r\n    })\r\n    .then((response) => response.data);\r\n\r\nexport default fetcher;\r\n","import dayjs from 'dayjs';\r\nimport { IUser, IChat, IDM } from '@typings/db';\r\n\r\nconst makeSection = (chatData: (IDM | IChat)[]) => {\r\n  return chatData.reduce((a, c) => {\r\n    if (!a[dayjs(c.createdAt).format('YYYY-MM-DD')]) {\r\n      a[dayjs(c.createdAt).format('YYYY-MM-DD')] = [c];\r\n    } else {\r\n      a[dayjs(c.createdAt).format('YYYY-MM-DD')].push(c);\r\n    }\r\n    return a;\r\n  }, {} as { [key: string]: (IDM | IChat)[] });\r\n};\r\n\r\nexport default makeSection;\r\n"],"names":["Button","_ref","className","text","onClick","React","type","concat","TextField","memo","id","label","_ref$type","onChange","value","htmlFor","ChatBox","chat","onSubmit","onChangeChat","placeholder","params","useParams","refTextarea","useRef","_useSWR","useSWR","workspace","fetcher","workspaceMembers","data","renderSuggestion","error","mutate","useCallback","suggestion","search","highlightedDisplay","index","focused","src","gravatar","email","s","d","alt","useEffect","current","autosize","MentionsInput","rows","inputRef","onKeyDown","e","key","shiftKey","trim","allowSuggestionsAboveCursor","Mention","appendSpaceOnAdd","trigger","map","v","display","nickname","ChatList","forwardRef","ref","chatData","setSize","setScrollValues","isReachingEnd","isEmpty","refScrollbars","handleScroll","values","scrollTop","prevSize","then","getScrollHeight","scrollHeight","console","log","Scrollbars","onScrollFrame","autoHide","Object","entries","_ref2","_ref3","date","chats","idx","Chat","user","Sender","User","dayjs","createdAt","format","content","useInput","initialData","_useState2","useState","state","setState","handler","target","sockets","disconnect","io","transports","undefined","createSvgIcon","_chatData$","_chatData","_useParams","channel","socket","_slicedToArray","useSocket","scrollValues","_useInput2","setChat","_useInput4","newChannelMember","setNewChannelMember","onChangeNewChannelMember","_useState4","openDialogInviteChannel","setOpenDialogInviteChannel","handleDialogInviteChannelClose","myData","channelData","_useSWRInfinite","useSWRInfinite","mutate2","length","savedChat","prevChatData","_chatData$0$","unshift","UserId","ChannelId","Channel","Date","setTimeout","_refScrollbars$curren","scrollToBottom","axios","withCredentials","catch","on","off","_refScrollbars$curren2","remakedChatData","makeSection","flat","reverse","dir","PersonAdd","Dialog","open","onClose","DialogTitle","DialogContent","DialogActions","url","response","reduce","a","c","push"],"sourceRoot":""}